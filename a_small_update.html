<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

	<meta name=og:title content="A Small Update">
	<meta name=og:url content=ancientstraits.github.io>

    <title>AncientStraits</title>
    <link rel="stylesheet" href="style/style.css">
    <link rel="stylesheet" href="style/codehilite.css">
</head>
<body>
    <header><a href=index.html>
        AncientStraits
    </a></header>
    <div class="post">
        <h1 class="title">A Small Update</h1>
        <h2 class="date">12 Dec 2022 at 10:57 AM</h2>
        <hr>
        <div class="content">
            <p>I have updated the <a href="https://github.io/ancientstraits/ancientstraits.github.io">blogging system</a> in two new ways:</p>
<ol>
<li>Replaced <code>highlight.js</code> (client-side) with <code>pygments</code> (server-side) for syntax highlighting</li>
<li>Added <code>meta</code> OpenGraph tags to make links look better in embeds</li>
</ol>
<h1>Pygments and CodeHilite</h1>
<p>Initially, my blogging script, <a href="https://github.com/ancientstraits/ancientstraits.github.io/blob/master/ssg.py">ssg.py</a>,
has worked by solely using the <code>fenced_code_blocks</code> extension for <code>python-markdown</code>, which puts code into a <code>pre</code> element without adding syntax highlighting.
The blog post used to load <code>highlight.js</code> into the browser to highlight the code blocks after the page was loaded.
This is clearly inefficient, because it adds JavaScript(TM) to my blog pages, and forces the browser to parse each block of code whenever it is loaded.
Now, the page uses <code>python-markdown</code>'s CodeHilite extension instead, which separates each lexical block into a <code>span</code> element, each of which is highlighted with a CSS class.
These CSS classes can be styled by using <code>pygments</code> to export a CSS file to implement the color of each class:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">pygments_css</span><span class="p">(</span><span class="n">style</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">arg</span><span class="o">=</span><span class="s1">&#39;.codehilite&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="n">pygments</span><span class="o">.</span><span class="n">formatters</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlFormatter</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="n">style</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">get_style_defs</span><span class="p">(</span><span class="n">arg</span><span class="o">=</span><span class="n">arg</span><span class="p">)</span>
</code></pre></div>

<p>Which is the Python equivalent of <code>pygmentize -S [style] -f html -a .codehilite</code> in Bash.
As of writing, I have chosen this style to be <code>gruvbox-dark</code>.
Unfortunately, I cannot change the whole style of the codeblocks simply by changing the <code>style</code> argument,
since I also have to change the foreground and background colors manually in <code>style/style.css</code>.</p>
<h1>OpenGraph</h1>
<p>OpenGraph tags are used when someone posts your program's link to a social media site, such as Twitter.
They are used to retrieve more information, so that a box of info about the website appears under the message where the link was posted.
I have added <code>title</code> and <code>url</code> tags to my post template:</p>
<div class="codehilite"><pre><span></span><code><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">og:title</span> <span class="na">content</span><span class="o">=</span><span class="s">{{title}}</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">og:url</span> <span class="na">content</span><span class="o">=</span><span class="s">ancientstraits.github.io</span><span class="p">&gt;</span>
</code></pre></div>

<p>This will perhaps make my posts gain more popularity when shared.</p>
        </div>
    </div>
</body>
</html>
